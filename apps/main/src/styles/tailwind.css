@import 'tailwindcss';

/* Enable dark mode via class (for manual toggle) instead of media query */
@custom-variant dark (&:where(.dark, .dark *));

/* Streamlined Tailwind CSS v4 Configuration for IrisNotes */
@theme {
  /* Essential layout dimensions */
  --sidebar-width: 300px;
  --sidebar-collapsed-width: 0px;
  --activity-bar-width: 48px;

  /* Focus indicator colors - solid colors to avoid opacity blending issues */
  --color-focus-light: #dbeafe;  /* blue-100 */
  --color-focus-dark: #132247;   /* blue-900/30 over gray-900, pre-computed */

  /* Editor-specific variables that change dynamically */
  --editor-font-size: 14px;
  --editor-bg: #f9fafb;
}

/* Dark mode configuration */
.dark {
  --editor-bg: #111827;
}

/* Fix select dropdown options in dark mode */
.dark select option {
  background-color: #374151; /* gray-700 */
  color: #f3f4f6; /* gray-100 */
}

select option {
  background-color: #f3f4f6; /* gray-100 */
  color: #111827; /* gray-900 */
}

/* Custom utility classes for application-specific functionality */
@layer utilities {
  /* Focus management utilities */
  .focus-indicator {
    @apply relative;
  }

  .focus-indicator::after {
    content: '';
    position: absolute;
    top: 4px;
    right: 4px;
    width: 8px;
    height: 8px;
    background-color: #22c55e;
    border: 1px solid white;
    border-radius: 50%;
    z-index: 100;
    pointer-events: none;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  }

  /* Debug border utilities for development */
  .__1 {
    border: 5px solid #ef4444 !important;
  } /* red */
  .__2 {
    border: 5px solid #3b82f6 !important;
  } /* blue */
  .__3 {
    border: 5px solid #22c55e !important;
  } /* green */
  .__4 {
    border: 5px solid #f59e0b !important;
  } /* amber */
  .__5 {
    border: 5px solid #8b5cf6 !important;
  } /* violet */
  .__6 {
    border: 5px solid #ec4899 !important;
  } /* pink */
  .__7 {
    border: 5px solid #06b6d4 !important;
  } /* cyan */
  .__8 {
    border: 5px solid #84cc16 !important;
  } /* lime */
  .__9 {
    border: 5px solid #f97316 !important;
  } /* orange */
  .__10 {
    border: 5px solid #6366f1 !important;
  } /* indigo */
  .__11 {
    border: 5px solid #14b8a6 !important;
  } /* teal */
  .__12 {
    border: 5px solid #eab308 !important;
  } /* yellow */
  .__13 {
    border: 5px solid #dc2626 !important;
  } /* red-600 */
  .__14 {
    border: 5px solid #7c3aed !important;
  } /* violet-600 */
  .__15 {
    border: 5px solid #059669 !important;
  } /* emerald-600 */

  /* Editor utilities */
  .editor-container {
    @apply h-full w-full;
    /* Use overflow-y auto for vertical scrolling, clip horizontal to contain active line highlight */
    overflow-y: auto;
    overflow-x: clip;
  }

  /* Zoom wrapper for editor content only (excludes toolbar) */
  .editor-content-zoom {
    zoom: var(--pm-zoom, 1);
  }

  .editor-scrollbar::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  .editor-scrollbar::-webkit-scrollbar-track {
    @apply bg-gray-200 dark:bg-gray-800;
    border-radius: 4px;
  }

  .editor-scrollbar::-webkit-scrollbar-thumb {
    @apply bg-gray-400 dark:bg-gray-600;
    border-radius: 4px;
  }

  .editor-scrollbar::-webkit-scrollbar-thumb:hover {
    @apply bg-gray-500 dark:bg-gray-500;
  }

  /* Layout utilities */
  .layout-transition {
    @apply transition-all duration-200 ease-in-out;
  }

  /* Component-specific utilities */
  .btn-focus {
    @apply focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2;
  }

  .input-focus {
    @apply focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500;
  }

  /* Debug utilities (development only) */
  .debug-border {
    @apply border-2 border-red-500;
  }

  .debug-bg {
    @apply bg-red-500 text-white;
  }

  /* React Complex Tree Custom Styling */
  .rct-tree-root {
    /* Compact tree styling */
    --rct-item-height: 24px;
    --rct-item-padding-horizontal: 8px;
    --rct-color-tree-bg: transparent;

    /* Light mode colors */
    --rct-color-focustree-item-selected-bg: rgb(239 246 255);
    --rct-color-focustree-item-selected-text: rgb(30 58 138);
    --rct-color-focustree-item-focused-bg: rgb(254 249 195);
    --rct-color-focustree-item-focused-text: rgb(120 53 15);
    --rct-color-focustree-item-focused-border: rgb(245 158 11);
    --rct-color-focustree-item-active-bg: rgb(243 244 246);
    --rct-color-focustree-item-active-text: rgb(55 65 81);
    --rct-color-focustree-item-hover-bg: rgb(249 250 251);
    --rct-color-focustree-item-hover-text: rgb(17 24 39);

    /* Arrows and expand/collapse */
    --rct-color-arrow: rgb(107 114 128);
    --rct-color-arrow-hover: rgb(55 65 81);

    /* Drag and drop */
    --rct-color-drag-between-line: rgb(59 130 246);
    --rct-color-drop-target: rgba(59, 130, 246, 0.1);
  }

  /* Dark mode overrides */
  .dark .rct-tree-root {
    --rct-color-focustree-item-selected-bg: rgb(30 58 138);
    --rct-color-focustree-item-selected-text: rgb(239 246 255);
    --rct-color-focustree-item-focused-bg: rgb(120 53 15);
    --rct-color-focustree-item-focused-text: rgb(254 249 195);
    --rct-color-focustree-item-focused-border: rgb(245 158 11);
    --rct-color-focustree-item-active-bg: rgb(55 65 81);
    --rct-color-focustree-item-active-text: rgb(243 244 246);
    --rct-color-focustree-item-hover-bg: rgb(31 41 55);
    --rct-color-focustree-item-hover-text: rgb(249 250 251);
    --rct-color-arrow: rgb(156 163 175);
    --rct-color-arrow-hover: rgb(209 213 219);
  }
}

/*
 * IrisNotes uses standard Tailwind classes with these custom additions:
 * - Focus management: .focus-indicator for green circle indicators
 * - Editor styling: .editor-container and .editor-scrollbar for consistent editor appearance
 * - Layout transitions: .layout-transition for smooth animations
 * - Focus utilities: .btn-focus and .input-focus for accessible interactive elements
 *
 * ProseMirror editor styles are located in: src/features/editor/components/rich-editor/prosemirror.css
 *
 * The application relies on Tailwind's built-in color, spacing, and typography scales
 * rather than custom variables for maximum compatibility and performance.
 */

/* CodeMirror selection highlight - ensure visible selection in code blocks */
/* Use high specificity to override oneDark theme */
.cm-editor .cm-selectionBackground,
.cm-editor .cm-content .cm-selectionBackground,
.cm-editor.cm-focused .cm-selectionLayer .cm-selectionBackground {
  background-color: rgba(59, 130, 246, 0.3) !important; /* blue-500 with 30% opacity */
}

.cm-editor.cm-focused .cm-selectionBackground,
.cm-editor.cm-focused .cm-content .cm-selectionBackground {
  background-color: rgba(59, 130, 246, 0.4) !important; /* slightly stronger when focused */
}

.dark .cm-editor .cm-selectionBackground,
.dark .cm-editor .cm-content .cm-selectionBackground,
.dark .cm-editor.cm-focused .cm-selectionLayer .cm-selectionBackground {
  background-color: rgba(96, 165, 250, 0.35) !important; /* blue-400 for dark mode */
}

.dark .cm-editor.cm-focused .cm-selectionBackground,
.dark .cm-editor.cm-focused .cm-content .cm-selectionBackground {
  background-color: rgba(96, 165, 250, 0.5) !important;
}

/* Also style the native selection as fallback */
.cm-editor .cm-line::selection,
.cm-editor .cm-line *::selection {
  background-color: rgba(59, 130, 246, 0.3) !important;
}

.dark .cm-editor .cm-line::selection,
.dark .cm-editor .cm-line *::selection {
  background-color: rgba(96, 165, 250, 0.35) !important;
}

/* CodeMirror cursor visibility */
.cm-editor .cm-cursor {
  border-left-color: #3b82f6 !important; /* blue-500 */
}

.dark .cm-editor .cm-cursor {
  border-left-color: #60a5fa !important; /* blue-400 */
}
